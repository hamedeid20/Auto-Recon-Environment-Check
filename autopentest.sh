#!/bin/bash

# Find All Checks
CHECK_DIR=($(find ./checks -type f))

# Include All Checks
for check in "${CHECK_DIR[@]}"; do
    source "$check"
done

banner(){
    echo "============================="
    echo " Development By Green Arrow "
    echo "============================="
}

# run All Check Functions
run_checks(){

    # Added Banner Details
    banner

    # run one by one function
    for check in "${CHECK_FUNCS[@]}"; do

        echo "[+] Running : $check"

        # call a Function
        $check

        # get command status
        status=$?

        # check command status (0 = Success & 1 -> n  = Fail )
        if [ $status -eq 0 ]; then
            echo "[+][OK] $check"
            echo "[+][OK] $check" >> ./storage/success.log

        else
            echo "[-][Fail]["$(date)"] $check"

            # check Errors found
            if [ -n "$error" ]; then
                echo "[-][Fail]["$(date)"] $check [Detailed] $error" >> ./storage/fail.log
            else
                echo "[-][Fail]["$(date)"] $check" >> fail.log
            fi

        fi
        echo "---------------------------------------"

    done
    echo "[+] Completed Successfully"
}

# Main Function
run_checks